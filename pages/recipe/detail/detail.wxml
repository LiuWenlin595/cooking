<!--pages/recipe/detail/detail.wxml-->
<view class="container">
  <!-- èœè°±å›¾ç‰‡ -->
  <image class="recipe-header-image" src="{{recipe.image || '/images/default-recipe.png'}}" mode="aspectFill"></image>

  <!-- èœè°±åŸºæœ¬ä¿¡æ¯ -->
  <view class="card">
    <view class="recipe-title-row">
      <text class="recipe-title">{{recipe.name}}</text>
      <text class="recipe-tag required" wx:if="{{recipe.isRequired}}">å¿…ç‚¹</text>
    </view>
    <text class="recipe-category">{{recipe.category}}</text>
    <text class="recipe-description">{{recipe.description || 'æš‚æ— æè¿°'}}</text>
    
    <view class="recipe-meta">
      <view class="meta-item">
        <text class="meta-label">ğŸ‘¥ ä»½é‡</text>
        <text class="meta-value">{{recipe.servings || 1}}äººä»½</text>
      </view>
      <view class="meta-item">
        <text class="meta-label">â± æ—¶é•¿</text>
        <text class="meta-value">{{recipe.cookTime || 'æœªçŸ¥'}}</text>
      </view>
      <view class="meta-item" wx:if="{{recipe.difficulty}}">
        <text class="meta-label">ğŸ“Š éš¾åº¦</text>
        <text class="meta-value">{{recipe.difficulty}}</text>
      </view>
    </view>
  </view>

  <!-- ç”¨æ–™ -->
  <view class="card" wx:if="{{recipe.ingredients && recipe.ingredients.length > 0}}">
    <view class="card-title">ğŸ“‹ ç”¨æ–™</view>
    <view class="ingredient-list">
      <view class="ingredient-item" wx:for="{{recipe.ingredients}}" wx:key="index">
        <text class="ingredient-name">{{item.name || item}}</text>
        <text class="ingredient-amount" wx:if="{{item.amount}}">{{item.amount}}</text>
      </view>
    </view>
  </view>

  <!-- åˆ¶ä½œæ­¥éª¤ -->
  <view class="card" wx:if="{{recipe.steps && recipe.steps.length > 0}}">
    <view class="card-title">ğŸ‘¨â€ğŸ³ åˆ¶ä½œæ­¥éª¤</view>
    <view class="step-list">
      <view class="step-item" wx:for="{{recipe.steps}}" wx:key="index" wx:for-index="stepIndex">
        <view class="step-number">{{stepIndex + 1}}</view>
        <view class="step-content">
          <text class="step-text">{{item.text || item}}</text>
          <image wx:if="{{item.image}}" class="step-image" src="{{item.image}}" mode="aspectFill" bindtap="previewStepImage" data-index="{{stepIndex}}"></image>
        </view>
      </view>
    </view>
  </view>

  <!-- è¥å…»ä¿¡æ¯ -->
  <view class="card" wx:if="{{recipe.nutrition}}">
    <view class="card-title">ğŸ¥— è¥å…»ä¿¡æ¯</view>
    <view class="nutrition-grid">
      <view class="nutrition-item" wx:for="{{nutritionList}}" wx:key="key">
        <text class="nutrition-value">{{item.value}}</text>
        <text class="nutrition-label">{{item.label}}</text>
      </view>
    </view>
  </view>

  <!-- æ“ä½œæŒ‰é’® -->
  <view class="action-buttons">
    <button class="btn btn-primary" bindtap="orderRecipe">ç‚¹è¿™é“èœ</button>
    <button class="btn btn-secondary" wx:if="{{isAdmin}}" bindtap="editRecipe">ç¼–è¾‘</button>
    <button class="btn btn-secondary" wx:if="{{isAdmin}}" bindtap="deleteRecipe">åˆ é™¤</button>
  </view>
</view>
